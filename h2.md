## x) Lue/katso/kuuntele ja tiivistä.
### € Jaswal 2020: Mastering Metasploit - 4ed: Chapter 1: Approaching a Penetration Test Using Metasploit (kohdasta Conducting a penetration test with Metasploit luvun loppuun eli "Summary" loppuun)


### a) Harjoittelemme omassa virtuaaliverkossa, jossa on Kali ja Metaspoitable. Osoita testein, että 1) koneet eivät saa yhteyttä Internetiin 2) Koneet saavat yhteyden toisiinsa. (Koneiden ja verkon asentamista ei tarvitse raportoida uudestaan, paitsi jos siinä on ongelmia)

Koneet pystyssä, ja eristettynä internetistä ottamalla kaapeli pois. 
Pingataan molemmilla koneilla googlea (8.8.8.8 ) ja toisiaan.

![image](https://github.com/user-attachments/assets/a236e37e-cd26-4558-bb2f-444aa347471e)

![image](https://github.com/user-attachments/assets/6fc789aa-5ecd-408d-9166-3d7ed6d3d32e)

Koneet eivät saa yhteyttä nettiin, mutta saavat yhteyden toisiinsa.

Metasp ip-osoite 192.168.168.3
Kalin ip 192.168.168.4

Näiden asennuksia en enää raportoi uudelleen, löytyvät edellisestä kotitehtävästäni H1.md.

### b) Ota Metasploit msfconsole käyttöön

Otan Metasploit msfconsolen käyttöön. 

    $ sudo msfconsole

Näin pääsen host-koneeltani Kalista käsiksi Metasploitiin.

![image](https://github.com/user-attachments/assets/233fe336-65c4-4742-b526-ee1888735315)

### c) Etsi Metasploitable porttiskannaamalla (db_nmap -sn). Tarkista selaimella, että löysit oikean IP:n - Metasploitablen weppipalvelimen etusivulla lukee Metasploitable.

Etsin Metaspn porttikannaamalla, näyttää löytyvän.

    $ db_nmap -sn 192.168.168.3

![image](https://github.com/user-attachments/assets/75646099-210f-4692-9cef-9f0fa31e3499)

Tarkistin vielä selaimella, että löysin oikean IP:n.

![image](https://github.com/user-attachments/assets/e4ac9057-82fe-407b-83f0-1a402467cf34)

### d) Porttiskannaa Metasploitable perusteellisesti. Tallenna tulokset Metasploitin tietokantoihin (db_nmap) ja tiedostoihin (nmap -oA foo).

Porttiskannataan Metasp ja tallennetaan tämä Metaspn tietokantoihin.

        $ db_nmap 192.168.168.3

![image](https://github.com/user-attachments/assets/9c79475f-e896-485a-a7be-a42632b51ada)

Tallennetaan tämä vielä Metaspn tiedostoihin, tässä näköjään vaatiikiin sudo-oikeuksia.

        $ sudo nmap -oA foo 192.168.168.3


![image](https://github.com/user-attachments/assets/7f0c4da6-aa2d-4c7e-b565-772181ac81ac)

### e) Tarkastele Metasploitin tietokantoihin tallennettuja tietoja komennoilla "hosts" ja "services". Kokeile suodattaa näitä listoja tai hakea niistä.

Annan alkuun help database-komennon, jotta näen tarkemmin erinäisiä komentoja millä tarkastella tietokantoihin tallennettuja tietoja. 

        $ help database
        
![image](https://github.com/user-attachments/assets/fb02cb04-b049-4e73-a3aa-3217a12e348e)

Okei, tällä komennolla näen mitä hosts(lists all hosts in the database) ja services(lists all services in the database) tekevät.

Annan host-komennon, ja saan tällä ao. tuloksen.

        $ hosts
        
![image](https://github.com/user-attachments/assets/9606bbf6-43dc-4996-bf37-03d64bbfe390)

Suodatan hosts -u komennolla listan niin, että näyttää vain ylhäällä olevat hostit.

        $ hosts -u
        
![image](https://github.com/user-attachments/assets/7eba78b6-2194-4dcb-b5fb-bccfe435b40f)

Services-komennolla haen servicet.

        $ services

![image](https://github.com/user-attachments/assets/4deb6802-1d44-466f-826b-da869212d00d)

Suodatan listaa hakemalla esim vain portin 21 servicen tiedot. 

        $ services -p 21

![image](https://github.com/user-attachments/assets/22616e36-9537-4d18-ad56-1ef2055c2732)




### f) Vertaile nmap:n omaa tiedostoon tallennusta ja db_nmap:n tallennusta tietokantoihin. Mitkä ovat eri tiedostomuotojen ja Metasploitin tietokannan hyvät puolet?


### g) Murtaudu Metasploitablen vsftpd-palveluun

Aloitan tehtävän muistuttelemalla mieleen tarkemmin mikä on vsftp-palvelu. " vsftpd (or very secure FTP daemon)[1] is an FTP server for Unix-like systems, including Linux. " (Wikipedia).
Okei, murtaudutaan sinne siis. Tätä demottiin jo tunnilla,jossa olin tehnyt jo kertaalleen, joten osa komennoista on kirjoitettu tällöin ylös.

        $ search vsftpd 2.3.4
        $ use 0
        $ set RHOST 192.168.168.3 / setg RHOST 127.0.0.1
        $ show options

![image](https://github.com/user-attachments/assets/329f59c2-c22e-4fe5-af59-b0bb7abb94eb)


[-] 127.0.0.1:21 - Exploit failed [unreachable]: Rex::ConnectionRefused The connection was refused by the remote host (127.0.0.1:21).

Hmm okei, ei toimi. Yritän hieman muokatulla komennolla, setg RHOST 127.0.0.1. EI auta. 

Keskeytän session, jos tällä välin olisi mennyt jotain rikki.



### h) Päivitä äskeisen vsftpd-murron yhteydessä syntynyt sessio meterpretriin

### 



## Lähteet

https://docs.rapid7.com/metasploit/scanning-and-managing-hosts/ Luettu 5.11.2024


https://en.wikipedia.org/wiki/Vsftpd Luettu 5.11.2024

