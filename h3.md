Ao. vastaukset ovat osa kotitehtävää h3 Haaga-Helian tunkeutumistestaus-kurssilla, jota opettaa Tero Karvinen.

## x) Lue ja tiivistä. Muutama ranskalainen viiva riittää.

### Popov 2024: Hacktricks: Wireshark tricks

- Hacktricks sivulla on vinkkejä Wireshark-ohjelman käyttämiseen.
- Sivun alussa on linkattuna tutoriaaleja, jotka kattavat wiresharkin perusteiden käyttöä, ja vinkkejä siihen.
- Analyze --> Expert Information näyttää katsauksen analysoituihin paketteihin.
- CTRL+f voi hakea pakettien sisältöä
- Host HTTP headerin saa näkyviin apply as column-filtterillä

### Karvinen 2023: Find Hidden Web Directories - Fuzz URLs with ffuf
- webservereillä on usein salaisia directoryja(hakemisto), joihin ei ole olemassa valmiita linkkejä. Näitä voisi kokeilla etsiä manuaalisesti, esim /sercret, /.cvn, mutta fuffilla tämän voi tehdä nopeasti yhdellä työkalulla.
- Fuff on joohoin kehittämä web fuzzeri
- Artikkelissa opastetaan miten Fuffilla voi fuzzata hakemistoja, mutta Fuffia voi käyttää myös esim headereihin. post parametreihin, yms.


## a) Valitse valmis hyökkäys. Ota sellainen hyökkäys, jonka saat toimimaan omaan paikalliseen harjoitusmaaliin, kuten Metasploitableen. Demonstroi hyökkäyksen toiminta.

Aloitan nyt helpolla vaihtoehdolla, ja otan alkuun VSFTPD backdoorin. Mikäli ehdin vielä ennen palautusta, otan jonkun toisen hyökkäyksen.

## b) Sorsa. Selitä ja arvioi valitsemasi hyökkäyksen toimintaa lähdekoodista.

Kaivan VSFTPD lähdekoodin, jota katsottiinkin jo hieman tunnilla. 

![image](https://github.com/user-attachments/assets/67e35b77-847e-4ca0-b9e7-ec6be249110a)

![image](https://github.com/user-attachments/assets/7ddd75c4-906b-48d1-895f-48cc0f3deb22)

// Jatkuu toisena päivänä.

Yritän avata uusiksi lähdekoodia, mutta saan nyt virheilmoituksen;
![image](https://github.com/user-attachments/assets/7c44da37-8476-40f3-a934-a19fb6a70e40)

Edit anyway. 

Koodissa :) laitettuna usernamen perään aktivoi hyökkäyksen, jolloin portin 6200 kautta pääsee sisään..


## c) Snif snif. Selitä ja arvioi valitsemasi hyökkäyksen toimintaa verkkosnifferillä. Pohdi myös, miten näkyvä tämä hyökkäys tai kontrollikanava on verkossa. (Vapaaehtoinen bonus: liitä mukaan pcap tekemästäsi nauhoituksesta).

Nauhoitan hyökkäystä pienen pätkän verkkosnifferi Wiresharkilla.

![image](https://github.com/user-attachments/assets/19554c03-1fcc-4cbe-a6fe-6054ecb2274e)

Tästähän näkyy liikennettä kattavasti, ja näen kuvasta esim että rivillä 36 sourceip on Kalin, eli hyökkäävän koneen ip, ja destination metaspn ip. Näen mitä protokollaa on käytetty missäkin paketin siirrossa, tässä kohtaa TCP, ja mistä portista hyökkäys on mennyt mihin porttiin, montako bittia dataa on liikkunut missäkin kohtaa jne.

Tutkin tarkemmin kaapattua liikennettä wiresharkin eri osioilla;

statistics -> Conversationsista löytyy data jaoeteltuna;
![image](https://github.com/user-attachments/assets/d3773b22-8025-43b8-a346-91edaaf1bfef)

Otan tästä pcapin, mutta pcap on virtuaaliKalillani.

## d) Fuzzzz. Ratkaise dirfuz-1 artikkelista Karvinen 2023: Find Hidden Web Directories - Fuzz URLs with ffuf.



## Lähteet:
